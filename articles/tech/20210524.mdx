---
title: 'Mac Automatorを使った自動化 | 画像リサイズとフォーマット変換'
date: 2021-05-24
tags: []
category: 'その他'
thumbnail: 'https://images.unsplash.com/photo-1665956600293-4511bd26ea98?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwzNzQ1NzR8MHwxfHJhbmRvbXx8fHx8fHx8fDE2NjY1MjIwMDc&ixlib=rb-4.0.3&q=80&w=1080'
---

# Mac の自動化、Automatorとは

AutomatorはMacでの作業を自動化ができる標準アプリケーションです。

ドラッグ・ドロップでアクションを追加してプログラムを作成します。

単純な処理であればShellScriptなどを書くことで自動化できますが、Automatorを使うことでフォルダ検知ができるのでフォルダにファイルが追加されたときにプログラムの実行ができます。

# 画像リサイズとフォーマット変換を自動化する

Macのスクリーンショットはpng画像で保存されファイルサイズが大きいため、普段は`Imagemagick`を使いjpgへの変換やサイズの変更などを行っています。

今回はAutomatorを利用してリサイズとフォーマット変換作業の自動化を行います。

![img](https://i.gyazo.com/0ea54e1767105e816f1113fbf19c3bd2.png)

## アルゴリズム

1. フォルダ検知を選択し`screenshot`フォルダを選択する。
2. フィルタを使いリサイズされていない画像かどうかを判断する。
3. 画像サイズを`720x?`or`?x720`へ変換する。
4. 画像フォーマットを`jpeg`に変換する。
5. ファイル名を変更し保存する。

実行してみます。

実際にリサイズ後`_resized`というファイル名がつき`jpg`に変換されています。

![img](https://i.gyazo.com/3da9fc7093380d28ae3e91cae638700e.png)

## リサイズプログラムの注意点

リサイズプログラムでは画像が再帰的にリサイズされないよう注意が必要です。

ファイルが既にリサイズされているかどうかの判定アクションを忘れると永遠にリサイズが繰り返されます。

今回はpngからjpgへの変換なのでファイル拡張子がpngかどうかで判断しています。

他にも画像のexifにリサイズフラグを作成したり、ファイル名から判定するなどの方法があります。
